# 文件

### app.json

![image-20200103153929028](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200103153929028.png)

|      属性       |     类型     |                             描述                             |
| :-------------: | :----------: | :----------------------------------------------------------: |
|      pages      | String Array | 必填，记录小程序所有页面的路径地址，多个地址时候将默认第一个为小程序初始界面 |
|     window      |    Object    |                   可选，用于设置页面GUI：                    |
|     tabBar      |    Object    |              可选，设置页面底部tab工具条的表现               |
| network Timeout |    Object    |               可选，这只各种网络请求的超时时间               |
|      debug      |   Boolean    |                     用于是否开启调试模式                     |

##### window内容

|             属性             |   类型   | 默认值  |              描述               |
| :--------------------------: | :------: | :-----: | :-----------------------------: |
| navigationBarBackgroundColor | HexColor | #000000 |         导航栏背景颜色          |
|    navigationBarTextStyle    |  String  |  white  |         导航栏标题颜色          |
|    navigationBarTitleText    |  String  |         |         导航栏标题文字          |
|       navigationStyle        |  String  | default | 导航栏样式（default or custom） |
|     backgroundTextStyle      |  String  |  dark   | 下拉加载的样式（dark or light） |
|       backgroundColor        | HexColor | #ffffff |          窗口背景颜色           |
|      backgroundColorTop      |  String  | #ffffff |    顶部窗口颜色（iOS only）     |
|    backgroundColorBottom     |  String  | #ffffff |    底部窗口颜色（iOS only）     |
|    enablePullDownRefresh     | Boolean  |  false  |        是否开启下拉刷新         |
|    onReachBottomDistance     |  Number  |   50    |    页面上拉触底事件触发距离     |

##### tabBar内容

![image-20200103163115202](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200103163115202.png)

###### tabBar项

|      属性       |   类型   | 必填 | 默认值 |              描述               |
| :-------------: | :------: | :--: | :----: | :-----------------------------: |
|      color      | HexColor | 必填 |        |         tab文字默认颜色         |
|  selectedColor  | HexColor | 必填 |        |        tab文字选中时颜色        |
| backgroundColor | HexColor | 必填 |        |           tab背景颜色           |
|   borderStyle   |  String  | 可选 | black  | tab上边框颜色（black or white） |
|      list       |  Array   | 必填 |        |             tab列表             |
|    position     |  String  | 可选 | bottom |   tabBar位置（top or bottom）   |

###### list项

|       属性       |  类型  | 必填 |        描述        |
| :--------------: | :----: | :--: | :----------------: |
|     pagePath     | String | 必填 | 页面路径（已定义） |
|       text       | String | 必填 |    tab按键文字     |
|     iconPath     | String | 可选 |      图标路径      |
| selectedIconPath | String | 可选 |   选中时图标路径   |

### 其他.json

|             属性             |   类型   | 默认值  |                   描述                    |
| :--------------------------: | :------: | :-----: | :---------------------------------------: |
| navigationBarBackgroundColor | HexColor | #000000 |              导航栏背景颜色               |
|    navigationBarTextStyle    |  String  |  white  |              导航栏标题颜色               |
|    navigationBarTitleText    |  String  |         |              导航栏标题文字               |
|     backgroundTextStyle      |  String  |  dark   |      下拉加载的样式（dark or light）      |
|       backgroundColor        | HexColor | #ffffff |               窗口背景颜色                |
|    enablePullDownRefresh     | Boolean  |  false  |             是否开启下拉刷新              |
|    onReachBottomDistance     |  Number  |   50    |         页面上拉触底事件触发距离          |
|        disableScroll         | Boolean  |  false  | 单独设置true（无法下拉）、false（可下拉） |

# 框架

### 逻辑层

#### 注册程序

##### app()方法

|       属性       |   类型   |                描述                |       触发时机       |       备注       |
| :--------------: | :------: | :--------------------------------: | :------------------: | :--------------: |
|    onLaunch()    | Function | 监听小程序的初始化（生命周期函数） |        初始化        |  全局只触发1次   |
|     onShow()     | Function |  监听小程序的显示（生命周期函数）  |  启动/后台进入前台   |                  |
|     onHide()     | Function |  监听小程序的隐藏（生命周期函数）  |     前台进入后台     |                  |
|    onError()     | Function |            错误监听函数            | 脚本错误/API调用失败 |                  |
| omPageNotFound() | Function |           页面不存在函数           |  需打开的页面不存在  |                  |
|  其他自定义参数  |   Any    |          开发者自定义函数          |                      | 通过this函数触发 |

##### onLaunch() & onShow()方法

![image-20200103213012114](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200103213012114.png)

###### 函数返回值

|          字段          |  类型  |                             说明                             |
| :--------------------: | :----: | :----------------------------------------------------------: |
|          path          | String |                       打开小程序的路径                       |
|         query          | Object |                      打开小程序的query                       |
|         scene          | Number |                      打开小程序的场景值                      |
|      shareTicket       | String | 小程序被转发时生成一个shareTicket，打开被转发的小程序页面可以获取该函数 |
|      referrerInfo      | Object |      当场景为从另一个小程序/公众号/App打开时返回此字段       |
|   referrerInfo.appId   | String |               跳转前的小程序/公众号/App的appId               |
| referrerInfo.extraData | Object |     跳转前的小程序传来的数据，当scene=1037/1038时才支持      |

###### 支持返回referrerInfo.appId的场景值

| 场景值 |             场景              |    appId信息的含义    |
| :----: | :---------------------------: | :-------------------: |
|  1020  | 公众号profile页相关小程序列表 | 返回来源公众号的appId |
|  1035  |       公众号自定义菜单        | 返回来源公众号的appId |
|  1036  |        App分享消息卡片        |  返回来源应用的appId  |
|  1037  |       小程序打开小程序        | 返回来源小程序的appId |
|  1038  |      从另一个小程序返回       | 返回来源小程序的appId |
|  1043  |        公众号模板信息         | 返回来源公众号的appId |

##### onPageNotFound()方法

|    字段     |  类型   |                             说明                             |
| :---------: | :-----: | :----------------------------------------------------------: |
|    path     | String  |                       不存在页面的路径                       |
|    query    | Object  |                    打开不存在页面的query                     |
| isEntryPage | Boolean | 是否为本次启动的首个页面（如：从分享点进来，则首个页面则是配置的分享页面） |

#### 注册页面

##### Page(OBJECT)方法

###### OBJECT参数

|        属性         |   类型   |                             说明                             |
| :-----------------: | :------: | :----------------------------------------------------------: |
|        data         |  object  |                        页面的初始数据                        |
|      onLoad()       | Function |                 监听页面加载（生命周期函数）                 |
|      onReady()      | Function |             监听页面初次渲染完成（生命周期函数）             |
|      onShow()       | Function |                监听页面的显示（生命周期函数）                |
|      onHide()       | Function |                监听页面的隐藏（生命周期函数）                |
|     onUnload()      | Function |                监听页面的卸载（生命周期函数）                |
| onPullDownRefresh() | Function |          监听用户的下拉动作（页面相关事件处理函数）          |
|   onReachBottom()   | Function |                    页面上拉触底事件的处理                    |
| onShareAppMessage() | Function |                      用户单机右上角转发                      |
|   onPageScroll()    | Function |                    页面滚动触发事件的处理                    |
|   onTabItemTap()    | Function |                 若当前是tab页，单机tab时触发                 |
|      其他函数       |   Any    | 开发者可以添加任意函数或数据到OBJECT参数中，在页面的函数中用this可以访问 |

###### 初始数据

在data内部定义一系列的常量，留待WXML文件对它的调用；

###### 生命周期函数

见上表；

###### 页面事件处理函数

- onPullDownRefresh()

- onReachBottom()

- onPageScroll(OBJECT)

- onShareAppMessage(OBJECT)

  onShareAppMessage(OBJECT)的方法object：

|    参数    |  类型  |                        说明                         | 最低版本 |
| :--------: | :----: | :-------------------------------------------------: | :------: |
|    from    | String | 转发事件来源（button：转发按钮 or menu：转发菜单）  |  1.2.4   |
|   target   | Object | if from==button target=button else target=undefined |  1.2.4   |
| webViewUrl | String |      页面中包含<web_view>时返回<web_view>的url      |  1.6.4   |

​		onShareAppMessage(OBJECT)的返回值object：

|   字段   |      说明      |
| :------: | :------------: |
|  title   |    转发标题    |
|   path   |    转发路径    |
| imageUrl | 自定义图片路径 |

- onTabItemTap(OBJECT)

  |   参数   |  类型  |           说明            | 最低版本 |
  | :------: | :----: | :-----------------------: | :------: |
  |  index   | String |   被单击的tabItem的序号   |  1.9.0   |
  | pagePath | String | 被单击的tabItem的页面路径 |  1.9.0   |
  |   text   | String | 被单击的tabItem的按钮文字 |  1.9.0   |

  ![image-20200104191812572](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200104191812572.png)

###### route

在Page()中可以用this.route调用查看当前路径的地址；

###### setData

Page()中可同步更新data中的内容，同时异步更新至WXML中

![image-20200104194305633](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200104194305633.png)

![image-20200104194324409](C:\Users\GiannisChen\AppData\Roaming\Typora\typora-user-images\image-20200104194324409.png)

###### 生命周期

流程图略

#### 页面路由

###### 页面栈

- 页面之间的切换由框架统一管理（以栈的方式）；

###### 余下日后补（第一遍速成）

#### 模块化

文件局部变量+通过require调用

```javascript
var common=require('../../utils/common.js')   //目前暂不支持绝对路径地址
```

#### API

瞎几把调用就完事了！！！

### 视图层

#### WXML

AKA：WeiXin Markup Language

##### 数据绑定

| 分类         | 规则                                    | 描述                    |
| ------------ | --------------------------------------- | ----------------------- |
| 简单绑定     | <view>{{变量名}}</view>                 | 变量名在data中定义      |
| 组件属性绑定 | <view id='{{id}}'>测试</view>           | id也在data中定义        |
| 控制属性绑定 | <view wx:if='{{condition}}'>测试</view> | condition=false则不显示 |
| 关键字绑定   | <view wx:if='{{false}}'>测试</view>     | 效果同上                |
| 运算绑定     | 在上述内容里用运算字符串替代部分内容    | 略                      |

##### 列表渲染（数组）

就数组；

##### 条件渲染

- 简单条件：if-elseif-else

```javascript
<view wx:if="{{condiction}}"></view>
<view wx:elseif="{{condiction}}"></view>
<view wx:else></view>
```

- 多节点条件：多个组件同时判断

```javascript
<block wx:if="{{true}}">
    <view>A</view>
	<view>B</view>
</block>
```

- wx:if与hidden

  wx:if逻辑与hidden相反；

##### 模板

```javascript
<!--定义模板-->
<template name="a">
    <view>
    	<text>A:{{A}}</text>
		<text>A:{{A}}</text>
	</view>
</template>

<!--使用模板-->
<template is="myTemp" data="{{...student}}"/>
```

##### 事件

视图层到逻辑层的通信方式

```javascript
<!--使用方式-->
  <button id="myBtn" bindtap="myTap" data-my="hello">按钮组件</button>

<!--自定义函数-->
  Page({
      myTap: function(e){
          console.log(e);
      }
  })
```

###### 冒泡事件

当一个组件上的事件被触发后，该事件会向父节点传递；对应的，非冒泡事件就不会向父节点传；

|        类型        |                           触发条件                           |
| :----------------: | :----------------------------------------------------------: |
|     touchstart     |                       手指触摸动作开始                       |
|     touchmove      |                        手指触摸后移动                        |
|    touchcancel     |               手指触摸动作被内部打断，如来电等               |
|      touchend      |                       手指触摸动作结束                       |
|        tap         |                      手指触摸后马上离开                      |
|     longpress      | 手指触摸超过350ms后离开，如果指定了事件回调函数并触发，则tap不会响应 |
|      longtap       |                   使用longpress作为其替代                    |
|   transitionend    |      WXSS transition或wx.createAnimation动画结束后触发       |
|   animationstart   |                 WXSS animation动画开始时触发                 |
| animationiteration |               WXSS animation一次迭代结束后触发               |
|    animationend    |                 WXSS animation动画结束后触发                 |
|  touchforcechange  |           在支持3Dtouch的iPhone设备上重按时会触发            |

规则略

###### 事件对象

- 基础事件（BaseEvent）

  |     属性      |  类型   |              说明              |
  | :-----------: | :-----: | :----------------------------: |
  |     type      | String  |            事件类型            |
  |   timeStamp   | Integer |       事件生成时的时间戳       |
  |    target     | Object  | 出发时间的组件的一些属性值集合 |
  | currentTarget | Object  |    当前组件的一些属性值集合    |

- 自定义事件（CustomEvent）继承BaseEvent

  |  属性  |  类型  |   说明   |
  | :----: | :----: | :------: |
  | detail | Object | 额外信息 |

- 触摸事件（TouchEvent）继承BaseEvent

  |     属性      | 类型  |                     说明                     |
  | :-----------: | :---: | :------------------------------------------: |
  |    touches    | Array | 触摸事件，当前停留在屏幕中的触摸点信息的数组 |
  | changeTouches | Array |     触摸事件，当前变化的触摸点信息的数组     |

  

##### 引用

```javascript
<import src="xxx.wxml"/>
```

```javascript
<include src="xx.wxml"/>
```

- import：引入template
- include：引入除template以外的全部代码

#### WXSS

- WeiXin Style Sheets（微信样式表）用来描述WXML的组件样式，类似于CSS；

- 特性为尺寸单位和样式导入；

##### 尺寸单位

​		全新尺寸量度rpx（responsive pixel），无视设备原大小，统一设置屏幕宽度为750rpx；屏幕越大1rpx对应的物理像素就越大；

##### 样式导入

```css
common.wxss
.red{
    color:red;
}

a.wxss
@import "common.wxss";
.blue {
    color:blue;
}

@import引入后，两者都可以在a.wxss中使用
```

##### 常用属性

|     样式属性     |   含义   |     参考值     |
| :--------------: | :------: | :------------: |
| background-color |  背景色  |      red       |
|      color       |  前景色  |      red       |
|    font-size     | 字体大小 |      16px      |
|      border      |   边框   | 3px solid blue |
|      width       |   宽度   |      20px      |
|      height      |   高度   |     100px      |

##### 选择器

|     选择器      |     样例     |              描述               |
| :-------------: | :----------: | :-----------------------------: |
|     .class      |    .demo     | 选择所有class=".demo"属性的组件 |
|       #id       |    #test     |   选择所有id="test"属性的组件   |
|     element     |     view     |        选择所有view组件         |
| element,element |  view,text   |     选择所有view和text组件      |
|     ::after     | view::after  |     在view组件后面插入内容      |
|    ::before     | view::before |     在view组件前面插入内容      |

在app.wxss中设置可以全局定义，局部文件.wxss则在当前文件中覆盖app.wxss；

### flex布局

- flex模型，确保对应元素在应该在的位置；

- 容器和项目，container的嵌套，其元素为项目；

- 坐标轴，左上角为原点的直角坐标系，水平方向为主轴（main axis），垂直方向为交叉轴（cross axis）。当使用样式属性flex-direction:column时候，将main axis和cross axis做交换；

- flex属性：

  1. 容器属性：

     |       属性       |                 说明                 |   默认值   |                          其他有效值                          |
     | :--------------: | :----------------------------------: | :--------: | :----------------------------------------------------------: |
     |  flex-direction  |           设置项目排列方向           |    row     |             row-reverse\|column\|column-reverse              |
     |    flex-wrap     |           设置项目是否换行           |   nowrap   |                      wrap\|wrap-reserve                      |
     | justicfy-content |    设置项目在主轴方向上的对齐方式    | flex-start | flex-end\|center\|space_between\|space-around\|space-evently |
     |   align-items    |       设置水平方向上的对齐方式       |  stretch   |            center\|flex-end\|baseline\|flex-start            |
     |  align-content   | 多行排列时，设置在交叉轴上的排列方式 |  stretch   | flex-end\|center\|space_between\|space-around\|space-evently |

  2. 项目属性：

     |    属性     |            说明            | 默认值 |                   其他有效值                    |
     | :---------: | :------------------------: | :----: | :---------------------------------------------: |
     |    order    |   设置在主轴上的排序方式   |   0    |                    <integer>                    |
     | flex-shrink |   收缩在主轴上溢出的项目   |   1    |                    <number>                     |
     |  flex-grow  | 扩张在主轴上还有空间的项目 |   0    |                    <number>                     |
     | flex-basis  |    替代项目的宽/高属性     |  auto  |                    <length>                     |
     |    flex     |  上述三个flex-的综合简写   |   无   | none\|auto\|@flex-grow @flex-shrink @flex-basis |
     | align-self  |  设置行中交叉轴的对齐方式  |  auto  | flex-start\|flex-end\|center\|baseline\|stretch |

     